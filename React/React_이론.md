# React 이론 정리

복습용으로 최대한 축약하여 이해하는데 있어 어색함이나 부족함 없게끔 정리하는 것이 목표.

# 📚 React란?

리액트는 자바스크립트 라이브러리로 사용자 인터페이스(User Interface)를 만드는데 사용하고 오직 `뷰(View)`만을 신경 쓰는 라이브러리이다.

리액트 프로젝트에서 특정 부분이 어떻게 생길지 정하는 선언체가 있는데, 이를 `컴포넌트(component)`라고 한다.

컴포넌트(component)는 재사용이 가능한 AIP로 수많은 기능을 내장하며, 해당 컴포넌트의 생김새와 작동 방식을 정의한다.

이어서 사용자 화면에 뷰(View)를 보여 주는 것을 `렌더링(rendering)`이라고 부르는데 리액트에는 초기 렌더링과 리렌더링 두 개념으로 나뉜다.

## 📕 초기 렌더링

어떠한 UI 관련 프레임워크나 라이브러리던 맨 처음에 어떻게 보일지를 정하는 초기 렌더링은 필요한데 리액트에서는 이 역할을 render 함수가 담당한다.

```js
render() {...}
```

이 함수는 컴포넌트가 어떻게 생겼는지를 정의하며 뷰가 어떻게 생겼고, 어떻게 작동하는지에 대한 정보를 지닌 객체를 반환한다.

이 함수(render())를 실행하면 내부의 컴포넌트들을 렌더링 하게되고 최상위 컴포넌트의 렌더링 작업이 끝나면 지닌 정보를 이용해 HTML 마크업을 만들고, 이를 실제 페이지의 DOM 요소 안에 주입한다.

<img src="https://thebook.io/img/080203/037.jpg">

그다음 문자열 형태의 HTML 코드를 생성한 후 특정 DOM에 해당 내용을 주입하면 이벤트가 적용된다.

## 📗 리 렌더링

리액트에서 업데이트에 해당하는 리 렌더링(or 업데이트)는 데이터의 변화가 있을 때 변화에 맞춰 뷰를 변형시키는 것이 아니라 새로운 요소로 갈아 끼우는 것이다.

이 작업또한 `render()` 함수가 맡는다. 컴포넌트는 데이터를 업데이트했을 때 단순히 업데이트한 값을 수정하는 것이 아닌, 새로운 데이터로 render 함수를 다시 호출하고 그 데이터르 지닌 뷰를 다시 생성하는 것이다.

그러나 이렇게 render 함수가 새로운 뷰에 대한 반환 결과를 곧바로 DOM에 반영하지 않고 `이전`의 render() 함수가 만들었던 컴포넌트 정보와 `현재` render() 함수가 만든 컴포넌트 정보를 비교한다.

<img src="https://thebook.io/img/080203/038.jpg">

이후 자바스크립트를 사용하여 두 가지 뷰를 최소한의 연산으로 비교한 후, 둘의 차이를 알아내 최소한의 연산으로 DOM 트리를 업데이트한다.

<img src="https://thebook.io/img/080203/038_2.jpg">

방식 자체는 루트 노드부터 전체 컴포넌트를 다시 렌더링하는 것처럼 보이지만, 최적의 자원을 사용하여 수행하는 방식인 것이다.

# 📚 리액트의 특징

리액트의 주요 특징 중 하나는 Virtual DOM을 사용한다는 것이다. 그러나 이를 알기 위해선 우선 DOM에 대해 알 필요가 있다.(정리가 안되어 있음)

## ❓ DOM 이란?

DOM = Document Object Model의 약어로 객체로 문서 구조를 표현하는 방법이며 XML, HTML등의 방식으로 작성한다.

웹 브라우저는 DOM을 활용하여 객체에 자바스크립트와 CSS를 적용한다. `DOM`은 트리 형태라서 특정 노드를 찾거나 수정하거나 제거하거나 원하는 곳에 삽입할 수 있다.

<img src="https://thebook.io/img/080203/039.jpg">

DOM API는 수많은 플랫폼과 웹 브라우저에서 사용하지만, 한가지 치명적인 문제가 있는데 동적인 UI에 최적화 되어있지 않다는 것이다.

HTML은 그 자체적으로는 정적이며 자바스크립트를 활용하여야 동적으로 만들 수 있다.

예를 들어 페이스북 같은 경우 포스트 한 개가 표현하는 `<div>`요소는 100개 가량 됟나. 이렇게 규모가 큰 웹 어플리케이션에서 DOM에 직접 접근해 변화를 주면 나중에는 느려지는 성능 이슈가 발생할 수 밖에 없다.

그러나 DOM 자체는 매우 빠르다. DOM 자체를 읽고 쓸 때의 성능은 자바스크립트 객체를 처리할 때의 성능과 비교하여 크게 다르지 않다.

다만 웹 브라우저 단에서 DOM에 변화가 일어날 때 웹 브라우저가 CSS를 다시 연산하고, 레이아웃을 구성하고, 페이지를 리페인트 하기 때문에 이 과정에서 시간이 허비된다.

> 해결법

HTML 마크업을 시각적인 형태로 변환하는 것은 웹 브라우저의 주 역할이고, 이를 처리할 때 컴퓨터 자원을 사용하는 것은 어쩔 수 없다.

때문에 DOM을 조작할 때마다 엔진이 웹 페이지를 새로 그리기 때문에 이런 DOM을 최소한으로 조작하여 작업을 처리하는 방식으로 개선이 가능한데 리액트가 바로 `Virtual DOM 방식`을 이용하여 DOM 업데이트를 추상화함으로 DOM 처리 횟수를 최소화하고 효율적으로 진행한다.

## 📗 Virtual DOM

Virtual DOM은 실제 DOM에 접근하여 조작하는 대신, 이를 추상화한 자바스크립트 객체를 구성하여 사용한다. 실제 DOM의 가벼운 사본이라고 생각하면 편할듯 하다.

리액트에서 데이터가 변하면 웹 브라우저에 실제 DOM을 업데이트하는 데에는 다음의 세 가지 단계가 있다.

1. 데이터를 업데이트 하면 전체 UI를 Virtual DOM에 리렌더링한다.
2. 이전 Virtual DOM에 있던 내용과 현재 Virtual DOM의 내용을 비교한다.
3. 바뀐 부분만 실제 DOM에 적용한다.

<img src="https://thebook.io/img/080203/041.jpg">

그러나 Virtual DOM을 사용한다고 사용하지 않을때와 비교해서 무조건 빠르지 않다.

리액트는 `지속적으로 데이터가 변화하는 대규모 어플리케이션 구축하기`라는 목적이 있다.

리액트와 Virtual DOM이 언제나 제공하는 것은 업데이트 처리 간결성이다. UI를 업데이트하는 과정에서 생기는 복잡합을 모두 해소하고, 더욱 쉽게 업데이트 할 수 있게 해준다.

## 📕 리액트의 기타 특징

일부 웹 프레임워크가 MVC(Model-View-Controller)나 MVW(Model-View-Whatever // ex : AngularJS)등의 구조가 아닌 오직 뷰(View)만 담당한다.

또한 리액트는 프레임워크가 아닌 라이브러리이다. 다른 웹 프레임워크가 Ajax, 데이터 모델링, 라우팅 등의 기능을 내장하고 있는 반면, 리액트는 뷰(View)만 신경 쓰는 라이브러리이므로 기타 기능은 직접 구현하여 사용해야 한다.

그러나 이러한 부분들 또한 리액트 라우터(react-router), Ajax 처리를 위한 axios나 fetch, 상태 관리에 리덕스(redux)나 MobX등을 사용하면 된다.

<img src="https://thebook.io/img/080203/042.jpg">

또한 리액트는 다른 웹 프레임워크나 라이브러리와 혼용이 가능하다. Backbone.js나 AngularJS 등의 프레임워크와도 언제든 사용이 가능하다.

<img src="https://thebook.io/img/080203/042_2.jpg">

## 📘 리액트 개발 도구

리액트 프로젝트를 생성하는데 있어서 Node.js(크롬 V8 자바스클비트 엔진으로 빌드한 자바스크립트 런타임)는 필수다.

리액트 애플리케이션은 웹 브라우저에서 실행되는 코드로 주로 사용하는 개발 도구로는 ECMAScript6를 호환시켜 주는 `바벨(babel)`, 모듈화된 코드를 한 파일로 합치고(번들링) 코드를 수정할 떄마다 웹 브라우저를 리로딩 하는 등의 여러 기능을 지닌 `웹팩(webpack)`등이 있다.

## 📙 create-react-app

`create-react-app`은 리액트 프로젝트를 생성할 때 필요한 `웹팩`, `바벨`의 설치 및 설정 과정을 생략하고 바로 간편하게 프로젝트 작업 환경을 구축해 주는 도구이다.

터미널에 다음과 같이 입력하면 된다.

**$ npm create react-app hello-react**

## 📒 번들러(bundler)

위의 명령어로 리액트 프로젝트를 만들면 다음과 같은 구문을 맞이하게된다.

```js
import React from "react";
```

이 코드는 리액트를 불러와서 사용할 수 있게 해준다. 리액트 프로젝트 생성 시 node_modules라는 디렉터리가 생성되는데 여기에 react 모듈이 같이 설치되고, 위와 같은 구문으로 리액트를 불러와 사용할 수 있다.

모듈을 사용하는 것은 원래 브라우저에는 없는 기능이다. 브라우저가 아닌 환경에서 JavaScript를 실행할 수 있게 해주는 환경인 Node.js의 기능이다.(Node.js에서는 import가 아닌 require라는 구문을 사용하여 패키지를 불러옴)

이러한 기능을 브라우저에서도 사용하기 위해 번들러(bundler)를 사용한다. 단어 그 자체로 번들(bundle)은 파일을 묶듯이 연결하는 것을 의미한다.

<img src="https://thebook.io/img/080203/057.jpg">

리액트에선 주로 웹팩(WebpacK)이 편의성과 확장성이 뛰어나 주로 사용한다.

이러한 번들러 도구를 사용하면 import(or require)로 모듈을 불러왔을 때 불러온 모듈을 모두 합쳐 하나의 파일을 생성해 준다.(최적화 과정에선 여러 파일로 분리 될 수 있음)

실습 프로젝트에서 src/index.js를 시작으로 필요한 파일을 다 불러와 번들링하게 된다.

리액트에는 다음과 같이 파일을 import하는 구문또한 존재한다.

```js
import logo from ‘./logo.svg‘;
import ‘./App.css‘;
```

웹팩을 사용하면 위 코드 예시처럼 SVG파일과 CSS파일도 불러와 사용할 수 있다. 이렇게 파일을 불러오는 것은 웹팩의 `로더(loader)`라는 기능이 담당한다.

로더에는 CSS 파일을 불러오는 css-loader, 웹 폰트나 미디어 팡리을 불러오는 file-loader, 자바스크립트 파일을 불러오면서 최신 자바스크립트 문법으로 작성된 코드를 `바벨`이라는 도구를 사용해 ES5 문법으로 변환시키는 babel-loader 등이 있다.

이러한 웹팩의 로더는 원래 직접 설치하고 설정해야 하지만 create-react-app으로 프로젝트를 생성하면 이런 번거로운 작업을 모두 대신 해준다.
