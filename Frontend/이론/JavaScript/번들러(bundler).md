# 번들러(Bundler)

> 목표

1. 포괄적 의미에서 번들러란 무엇인가에 대한 개념 숙지
2. 번들러와 관련된 개념들의 내용 숙지
3. 번들러 사용시의 장, 단점 유무 파악

프론트엔드 개발에서 웹팩(Webpack), 파셀(Parcel)등의 이름을 마주하게 된다.

이러한 번들러들은 인터넷의 발달과 함께 수십만 줄에서 수백만 줄에 이르는 대규모 웹 서비스들이 생겨나면서 부터 생기는 문제점으로 인해 탄생되었다.

## 번들러의 등장 배경

번들러가 등장하게된 문제점들이 무엇인지 알아보자.

1. 중복된 이름으로 인한 에러

파일의 규모가 작다면 변수가 겹칠일도 적고 함수명또한 겹칠일이 적지만, 규모가 큰 프로젝트의 경우 수십 수백명의 개발자가 동시에 협업을 진행하기 때문에 변수명, 함수명의 오염과 같은  사이드 이펙트가 굉장히 쉽게 일어난다.

2. 파일 전송 문제

사용자가 브라우저에서 URI를 입력하면, 입력하 URI에 맞는 파일을 서버로부터 가져온다.

이런 웹 애플리케이션을 구성하는 파일의 양이 많다면, 사용자의 요청에 응답하는 시간 또한 길어지게 된다.

만약 파일들의 크기가 매우 커서 1개의 파일을 요청하고 응답하는데 1초가 걸린다면, 100개, 1000개의경우에는 100초 ~ 1000초까지 걸리는 끔찍한 UX를 제공하게 된다.

하나의 파일에 모든 스크립트를 작성하면 이러한 문제를 해결할 수 있지만 이는 유지보수 측면에서는 매우 기피해야 할 안티 패턴에 해당된다.

이러한 문제들을 해결하기 위해 여러 파일을 하나로 묶어주는 `번들러(Bundler)`가 등장한 것이다.

대표적으로는 Webpack, Parcel, Rollup, Browserify등이 있다.

## 번들러의 기능

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcNBE4q%2Fbtq4K9syJFE%2FKboaLr30F7STXxdVqsLUI0%2Fimg.png"/>

번들러는 단순히 자바스크립트 파일만 묶는 것이 아닌 `애플리케이션에 필요한 모든 종류의 파일들`을 `모듈 단위`로 나누어 `최소한의 파일 묶음(번들)`로 만들어 낸다.

또한 자바스크립트 파일을 외부에서 `알아 보기 힘들게 코드로 변환시키는 작업(Uglify)`을 한다거나, 최신 문법의 자바스크립트를 모든 웹 브라우저에서 동작할 수 있게 끔 ES5문법으로 변환 하는 등 다양한 기능을 한다.


# 압축(Minify) && 난독화(Uglify)

> 압축과 난독화의 사용 이유

1. 서비스에서 공통으로 사용되는 주요 소스 코드들은 별도의 파일로 분리하여 사용이 가능하다.
2. 코드의 재사용이 가능하고, 캐시 적용 가능, CDN의 사용이 가능해진다.
3. 코드의 압축은 최소의 노력으로 큰 효과를 보는 최적화 방법 중 하나이다.
4. 압축을 통해 파일의 용량이 감소하며, 난독화를 통해 민감한 코드를 알아보기 어렵게 만들 수 있다.
5. 경우에 따라서는 스크립트의 수행 속도에 영향을 미친다.

> 압축(Minify)

압축은 전체 소스코드 중 아래와 같은 경우를 제거하는 작업을 말한다.

1. 불필요한 줄바꿈, 공백 및 들여 쓰기
2. 짧게 쓸수 있는 긴 구문(줄일 수 있는 if 구문, 형 변환 축약 등)
3. 스코프 내 사용하지 않는 변수
4. 주석문
5. 경우에 따라서 console.log, debugger등의 디버깅 구문 및 메소드 호출
6. 경우에 따라서 무의미한 메소드 호출 및 루프

> 난독화(Uglify)

난독화는 자바스크립트 코드 자체를 분석하기 어렵게 만드는 과정을 말한다.
1. 난독화를 하여도 보안처리 없이 주요 정보 및 루틴을 자바스크립트에 넣는 것은 매우 위험하다.
2. 변수명, 함수명 치환에서 자바스크립트 일부 루틴을 문자열로 바꿔 변수에 담고 뒤섞는 등의 여러 단계가 존재함.
3. 난독화 단계를 높일 수록 알아보기 힘듦.
4. 변수, 함수명 등이 줄어 용량이 감소하지만, 난독화 단계가 높아지면 코드 해석 및 실행 속도가 느려질 수 있다.

> 압축 시 유의점

코드 압축 시 모든 들여쓰기, 공백등이 제거되고 전체 코드가 한줄로 병합된다.

원본 코드에서 들여 쓰기, 공백, 세미 콜론, 대괄호, 콤바등이 바르게 사용되지 않았따면 압축된 코드가 정상적으로 동작하지 않을 수 있다.

문제는 자바스크립트는 명시적으로 수행되는 컴파일 과정이 없어 이런 오류를 사전에 알아내는 것이 쉽지 않다는 점이다.

## 번들러 사용의 장점

1. 네트워크 병목 현상 해결 : 여러 파일을 최적화 하여 하나의 파일로 묶기 대문에 파일의 크기가 줄어든다.
2. 모듈 단위 코딩 : 유지 보수가 편하고, 코드의 가독성이 향상된다.
3. 다양한 서드파티 기능 이용 가능 : Webpack의 경우 Babel-loader와 같은 로더를 이용해 모던 자바스크립트나 SASS를 사용할 수 있다.